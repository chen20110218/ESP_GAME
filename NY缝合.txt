loadstring(game:HttpGet("https://raw.githubusercontent.com/chen20110218/ESP_GAME/refs/heads/main/%E7%99%BD%E5%90%8D%E5%8D%95.txt",true))()
local function loadScript(url, scriptName)
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "加载中",
        Text = "正在加载" .. scriptName,
        Icon = "",
        Duration = 2
    })
    
    local loadSuccess, loadError = pcall(function()
        loadstring(game:HttpGet(url, true))()
    end)
    
    if loadSuccess then
        game:GetService("StarterGui"):SetCore("SendNotification", {
            Title = "成功",
            Text = scriptName .. "已成功加载",
            Icon = "",
            Duration = 5
        })
        return true
    else
        warn("加载" .. scriptName .. "失败: " .. tostring(loadError))
        game:GetService("StarterGui"):SetCore("SendNotification", {
            Title = "错误",
            Text = scriptName .. "加载失败",
            Icon = "",
            Duration = 5
        })
        return false
    end
end

local function checkServer()
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "欢迎使用NY",
        Text = "正在检测服务器...",
        Icon = "",
        Duration = 3
    })
    
    wait(2)
    
    local success, result = pcall(function()
        return game:GetService("MarketplaceService"):GetProductInfo(game.PlaceId).Name
    end)
    
    local gameName = success and result or "未知游戏"
    
    if string.find(string.lower(gameName), "the rake remastered") then
        game:GetService("StarterGui"):SetCore("SendNotification", {
            Title = "服务器检测",
            Text = "已检测到rake，正在加载rake功能",
            Icon = "",
            Duration = 5
        })
        
        wait(1)
        
        loadScript(
            "https://raw.githubusercontent.com/chen20110218/ESP_GAME/refs/heads/main/ESP-%E5%89%B2%E8%8D%89%E6%9C%BA.txt",
            "ESP功能"
        )
    else
        game:GetService("StarterGui"):SetCore("SendNotification", {
            Title = "服务器检测",
            Text = "没有扫描到服务器，为您开启通用功能",
            Icon = "",
            Duration = 5
        })
        
        wait(1)
        
        loadScript(
            "https://raw.githubusercontent.com/chen20110218/ESP_GAME/refs/heads/main/birdfly.txt",
            "飞行功能"
        )
    end
end

game.Players.LocalPlayer:WaitForChild("PlayerGui")
checkServer()

--自动喊话--
-- 获取服务
local Players = game:GetService("Players")
local TextChatService = game:GetService("TextChatService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

-- 等待玩家加入
local player = Players.LocalPlayer
if not player then
    Players.PlayerAdded:Wait()
    player = Players.LocalPlayer
end

-- 等待角色加载
if not player.Character then
    player.CharacterAdded:Wait()
end

-- 发送消息的函数
local function sendMessageMultipleTimes(message, times, interval)
    for i = 1, times do
        task.wait(interval)
        
        -- 检查新的TextChatService系统是否可用
        if TextChatService then
            -- 使用新的TextChatService系统
            local channel = TextChatService.TextChannels.RBXGeneral
            if channel then
                channel:SendAsync(message)
            else
                warn("无法找到通用聊天频道")
            end
        else
            -- 回退到旧版聊天系统（如果可用）
            local sayMessageRequest = ReplicatedStorage:FindFirstChild("SayMessageRequest")
            if sayMessageRequest then
                sayMessageRequest:FireServer(message, "All")
            else
                warn("无法找到SayMessageRequest，聊天系统可能不可用")
            end
        end
    end
end

-- 等待TextChatService初始化（如果需要）
if TextChatService and not TextChatService.TextChannels:FindFirstChild("RBXGeneral") then
    TextChatService.TextChannels.ChildAdded:Connect(function(child)
        if child.Name == "RBXGeneral" then
            task.wait(0.5) -- 额外等待0.5秒确保频道完全初始化
            sendMessageMultipleTimes("NuoYa最帅", 3, 0.1)
        end
    end)
else
    -- 如果频道已经存在或使用旧版系统，直接发送消息
    task.wait(1) -- 等待1秒确保玩家完全加载
    sendMessageMultipleTimes("NuoYa最帅", 3, 0.1)
end